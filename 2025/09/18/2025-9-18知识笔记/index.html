<!DOCTYPE html>

<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">

  <meta name="description" content="怎么使用verilog进行按键消抖和新建STM32F4的工程模板文件
1、按键消抖key_fliter.v
1234567891011121314151617181920212223242526272829303132module key_fliter #(    parameter CNT_20M">


<link rel="alternate" href="/atom.xml" title="风继续吹" type="application/atom+xml">
<meta name="theme-color" content="#5badf0">
<title>2025.9.18知识笔记 - 风继续吹</title>
<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
<link rel="shortcut icon" href="/favicon.png">

<link rel="stylesheet" href="/css/style.css">

<nav class="main-nav">
	
	    <a href="/">← Home</a>
	
	
	    <a href="/about/">About</a>
	
	    <a href="/archives/">Archives</a>
	
	<a class="cta" href="/atom.xml" data-no-instant>Subscribe</a>
</nav>

<section id="wrapper">
    <article class="post">
    <header>
        
            <h1>2025.9.18知识笔记</h1>
        
        <h2 class="headline">Sep 18 2025
        
            
            <a href="/categories/每日笔记/#每日笔记">每日笔记</a>
        
        </h2>
    </header>
</article>
<section id="post-body"><p>怎么使用verilog进行按键消抖和新建STM32F4的工程模板文件</p>
<h3 id="1、按键消抖"><a href="#1、按键消抖" class="headerlink" title="1、按键消抖"></a>1、按键消抖</h3><p>key_fliter.v</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> key_fliter #(</span><br><span class="line">    <span class="keyword">parameter</span> CNT_20MS=<span class="number">20&#x27;d1000000</span></span><br><span class="line">)(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> rst,</span><br><span class="line">    <span class="keyword">input</span> key_in,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> key_flag</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">reg</span> [<span class="number">19</span>:<span class="number">0</span>] counter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">always</span>@(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">negedge</span> rst) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span>(!rst)</span><br><span class="line">        counter&lt;=<span class="number">1&#x27;b0</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(key_in==<span class="number">1&#x27;b1</span>)  <span class="comment">//检测到高电平，立即清0</span></span><br><span class="line">        counter&lt;=<span class="number">1&#x27;b0</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(counter==CNT_20MS) <span class="comment">//到检测到按键持续低电平20ms的时候,保持这个counter，因为不需要再增加了，等到按键结束拉高，一次完整按键结束，counter自动清0</span></span><br><span class="line">        counter&lt;=CNT_20MS;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        counter&lt;=counter+<span class="number">1&#x27;b1</span>;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">always</span>@(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">negedge</span> rst) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span>(!rst)</span><br><span class="line">        key_flag&lt;=<span class="number">1&#x27;b0</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(counter==CNT_20MS-<span class="number">1</span>)<span class="comment">//检测到20ms稳定低电平，证明是一次完整的按键动作</span></span><br><span class="line">        key_flag&lt;=<span class="number">1&#x27;b1</span>;</span><br><span class="line">    <span class="keyword">else</span>   </span><br><span class="line">        key_flag&lt;=<span class="number">1&#x27;b0</span>;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<p>key.v</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> led(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> rst,</span><br><span class="line">    <span class="keyword">input</span> key_in,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> led</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">wire</span> key_flag;</span><br><span class="line"></span><br><span class="line">key_fliter #(</span><br><span class="line">    <span class="variable">.CNT_20MS</span>(<span class="number">20&#x27;d1000000</span>)</span><br><span class="line">)led_inst</span><br><span class="line">(</span><br><span class="line">    <span class="variable">.clk</span>(clk),</span><br><span class="line">    <span class="variable">.rst</span>(rst),</span><br><span class="line">    <span class="variable">.key_in</span>(key_in),</span><br><span class="line">    <span class="variable">.key_flag</span>(key_flag)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">always</span>@(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">negedge</span> rst) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span>(!rst)</span><br><span class="line">        led&lt;=<span class="number">1&#x27;b0</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(key_flag==<span class="number">1&#x27;b1</span>)</span><br><span class="line">        led&lt;=~led;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        led&lt;=led;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<h3 id="2、梅花代码小疑问"><a href="#2、梅花代码小疑问" class="headerlink" title="2、梅花代码小疑问"></a>2、梅花代码小疑问</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>​​#include &lt;stdbool.h&gt;​​：提供布尔类型支持，定义 bool、true、false，用于逻辑判断和状态标志，提升代码可读性。</p>
<p>​​#include &lt;stdint.h&gt;​​：提供精确位宽整数类型（如 uint8_t、int32_t），确保数据跨平台一致性，适用于硬件寄存器和协议数据处理。</p>
<p>初始化结构体，我们可以使用下列操作:<br>GPIO_InitTypeDef GPIO_InitStructure&#x3D;{0};<br>​​作用​​：将结构体所有成员​​显式清零​​（数值型为0，指针为NULL）。</p>
<p>我们也可以使用另外一种方法:<br>memset(&amp;GPIO_InitStructure, 0, sizeof(GPIO_InitTypeDef));<br>但是要注意要引入头文件 #include&lt;string.h&gt;</p>
<p>memset是 C 语言标准库中的内存操作函数，其核心作用为 ​​对指定内存区域进行快速填充​​。用一句话概括：<br>​memset将一段连续内存的每个字节强制设置为指定值​​，常用于初始化内存块或数据清零。<br>memset函数举例子:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 清零结构体（防御未初始化风险）</span></span><br><span class="line">GPIO_InitTypeDef config;</span><br><span class="line"><span class="built_in">memset</span>(&amp;config, <span class="number">0</span>, <span class="keyword">sizeof</span>(config));  <span class="comment">// 所有字节置0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 填充特定模式（如0xFF）</span></span><br><span class="line"><span class="type">uint8_t</span> buffer[<span class="number">100</span>];</span><br><span class="line"><span class="built_in">memset</span>(buffer, <span class="number">0xFF</span>, <span class="keyword">sizeof</span>(buffer)); <span class="comment">// 全填充为0xFF</span></span><br></pre></td></tr></table></figure>

<p>static const led_desc_t led1 &#x3D;<br>{<br>    .clk_source &#x3D; RCC_AHB1Periph_GPIOE,<br>    .port &#x3D; GPIOE,<br>    .pin &#x3D; GPIO_Pin_6,<br>    .on_lvl &#x3D; Bit_RESET,<br>    .off_lvl &#x3D; Bit_SET,<br>};<br>static用于修饰结构体变量 led1（而非结构体类型 led_desc_t）<br>核心作用​​:<br>​​将 led1变量的作用域限制为当前源文件​​，其他文件无法通过 extern引用该变量，实现以下目标：<br>​​避免命名冲突​​：多个文件可定义同名的 led1变量而不会引发链接错误。</p>
<p>const的作用:<br>硬件配置的确定性​​：<br>LED的引脚、时钟源等参数在硬件设计阶段就已固定，运行时修改无意义且可能导致故障。<br>示例（尝试修改会触发编译错误）：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">led1.pin = GPIO_Pin_7;  <span class="comment">// 编译报错！const禁止修改&#x27;</span></span><br></pre></td></tr></table></figure>

<p>const修饰的变量会被编译器特殊处理，其存储位置和访问方式与普通变量不同。具体到您的代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">led_desc_t</span> led1 = &#123; ... &#125;;  <span class="comment">// const变量</span></span><br></pre></td></tr></table></figure>
<p>存储位置：Flash（而非RAM）​​<br>​​普通变量​​：存储在RAM中，可读可写，但RAM空间有限（如STM32F4仅有192KB RAM）。</p>
<p>​​const变量​​：</p>
<p>编译器会将其放入 ​​Flash（只读存储器）​​ 中（例如STM32F4的1MB Flash），因为它的值在运行时不需要修改。</p>
<p>​​意义​​：节省宝贵的RAM空间，尤其对资源紧张的嵌入式设备至关重要。</p>
<p>我们在这里再来详细得讲解一下static这个关键字的作用吧<br>①修饰局部变量（函数内部）​​<br>​​作用​​：</p>
<p>✅ ​​延长生命周期​​</p>
<p>普通局部变量在函数调用结束后销毁，而static局部变量​​在程序整个运行期间存在​​（存储在静态存储区）。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">counter</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> count = <span class="number">0</span>;  <span class="comment">// 只初始化一次，函数调用间保持值</span></span><br><span class="line">    count++;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, count);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>第一次调用：输出 1</li>
<li>第二次调用：输出 2（保留上次的值）</li>
</ul>
<p>②在C语言中，​​不加static的全局变量或函数​​可以被整个程序中的所有源文件访问，而​​加了static的全局变量或函数​​则只能被​​当前所在的源文件​​访问，其他文件无法使用它。</p>
<p>通俗解释​​<br>​​不加 static（默认情况）​​：</p>
<p>全局变量或函数是“公开的”，其他文件只要用 extern声明就能访问。</p>
<p>比如：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// file1.c</span></span><br><span class="line"><span class="type">int</span> global_var = <span class="number">10</span>;  <span class="comment">// 全局变量，其他文件可用</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">public_func</span><span class="params">()</span> &#123;   <span class="comment">// 全局函数，其他文件可用</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// file2.c</span></span><br><span class="line"><span class="keyword">extern</span> <span class="type">int</span> global_var;  <span class="comment">// 声明后即可使用</span></span><br><span class="line"><span class="keyword">extern</span> <span class="type">void</span> <span class="title function_">public_func</span><span class="params">()</span>;  <span class="comment">// 声明后即可调用</span></span><br></pre></td></tr></table></figure>

<p>加 static​​：</p>
<p>全局变量或函数变成“私有的”，只能在当前文件内使用，其他文件无法访问。</p>
<p>比如：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// file1.c</span></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> private_var = <span class="number">20</span>;  <span class="comment">// 只能在本文件使用</span></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">private_func</span><span class="params">()</span> &#123;  <span class="comment">// 只能在本文件调用</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Secret&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// file2.c</span></span><br><span class="line"><span class="keyword">extern</span> <span class="type">int</span> private_var;  <span class="comment">// 错误！无法访问</span></span><br><span class="line"><span class="keyword">extern</span> <span class="type">void</span> <span class="title function_">private_func</span><span class="params">()</span>;  <span class="comment">// 错误！无法调用</span></span><br></pre></td></tr></table></figure>


<p>​​C语言标准规定​​：</p>
<p>static​​不能用于修饰结构体类型定义​​，它只能修饰变量或函数。这样的代码在 C 语言中 ​​没有实际作用​​，编译器可能会忽略 static或给出警告。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ❌ 无意义：static 修饰结构体类型（C语言不支持）</span></span><br><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">Point</span> &#123;</span>  <span class="comment">// 编译器可能忽略或警告</span></span><br><span class="line">    <span class="type">int</span> x;</span><br><span class="line">    <span class="type">int</span> y;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>static可以用于修饰结构体变量</p>
<p>此时结构体类型​​仅在当前文件可用</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ✅ file1.c（结构体定义不暴露给其他文件）</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SecretData</span> &#123;</span>  <span class="comment">// 仅当前文件可用</span></span><br><span class="line">    <span class="type">int</span> id;</span><br><span class="line">    <span class="type">char</span> name[<span class="number">20</span>];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">SecretData</span> <span class="title">data</span>;</span>  <span class="comment">// 变量也限制为文件内可见</span></span><br></pre></td></tr></table></figure>




<h3 id="3、常规方法点亮LED"><a href="#3、常规方法点亮LED" class="headerlink" title="3、常规方法点亮LED"></a>3、常规方法点亮LED</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f4xx.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">led_delay</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">uint32_t</span> a = <span class="number">0</span>; a &lt; <span class="number">1000</span>; a++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">uint32_t</span> b = <span class="number">0</span>;b &lt; <span class="number">1000</span>; b++)</span><br><span class="line">        &#123;</span><br><span class="line">            __NOP();</span><br><span class="line">            __NOP();</span><br><span class="line">            __NOP();</span><br><span class="line">            __NOP();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">led_init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 打开外设时钟</span></span><br><span class="line">    RCC_AHB1PeriphClockCmd(RCC_AHB1Periph_GPIOE, ENABLE);</span><br><span class="line">    RCC_AHB1PeriphClockCmd(RCC_AHB1Periph_GPIOC, ENABLE);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 配置GPIO</span></span><br><span class="line">    GPIO_InitTypeDef gpio_init;</span><br><span class="line">    <span class="built_in">memset</span>(&amp;gpio_init, <span class="number">0</span>, <span class="keyword">sizeof</span>(GPIO_InitTypeDef));</span><br><span class="line"></span><br><span class="line">    gpio_init.GPIO_Pin = GPIO_Pin_5;</span><br><span class="line">    gpio_init.GPIO_Mode = GPIO_Mode_OUT;</span><br><span class="line">    gpio_init.GPIO_OType = GPIO_OType_PP;</span><br><span class="line">    gpio_init.GPIO_Speed = GPIO_Medium_Speed;</span><br><span class="line">    GPIO_Init(GPIOE, &amp;gpio_init);</span><br><span class="line"></span><br><span class="line">    gpio_init.GPIO_Pin = GPIO_Pin_6;</span><br><span class="line">    gpio_init.GPIO_Mode = GPIO_Mode_OUT;</span><br><span class="line">    gpio_init.GPIO_OType = GPIO_OType_PP;</span><br><span class="line">    gpio_init.GPIO_Speed = GPIO_Medium_Speed;</span><br><span class="line">    GPIO_Init(GPIOE, &amp;gpio_init);</span><br><span class="line"></span><br><span class="line">    gpio_init.GPIO_Pin = GPIO_Pin_13;</span><br><span class="line">    gpio_init.GPIO_Mode = GPIO_Mode_OUT;</span><br><span class="line">    gpio_init.GPIO_OType = GPIO_OType_PP;</span><br><span class="line">    gpio_init.GPIO_Speed = GPIO_Medium_Speed;</span><br><span class="line">    GPIO_Init(GPIOC, &amp;gpio_init);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 启动GPIO</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    led_init();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        GPIO_WriteBit(GPIOE, GPIO_Pin_5, Bit_RESET);</span><br><span class="line">        GPIO_WriteBit(GPIOE, GPIO_Pin_6, Bit_RESET);</span><br><span class="line">        GPIO_WriteBit(GPIOC, GPIO_Pin_13, Bit_RESET);</span><br><span class="line">        led_delay();</span><br><span class="line">        GPIO_WriteBit(GPIOE, GPIO_Pin_5, Bit_SET);</span><br><span class="line">        GPIO_WriteBit(GPIOE, GPIO_Pin_6, Bit_SET);</span><br><span class="line">        GPIO_WriteBit(GPIOC, GPIO_Pin_13, Bit_SET);</span><br><span class="line">        led_delay();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="4、使用对象方法点亮LED"><a href="#4、使用对象方法点亮LED" class="headerlink" title="4、使用对象方法点亮LED"></a>4、使用对象方法点亮LED</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f4xx.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">led_desc</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">uint32_t</span> clk_source;</span><br><span class="line">    GPIO_TypeDef *port;</span><br><span class="line">    <span class="type">uint16_t</span> pin;</span><br><span class="line">    BitAction on_lvl;</span><br><span class="line">    BitAction off_lvl;</span><br><span class="line">&#125; <span class="type">led_desc_t</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">led_desc_t</span> led0 =</span><br><span class="line">&#123;</span><br><span class="line">    .clk_source = RCC_AHB1Periph_GPIOE,</span><br><span class="line">    .port = GPIOE,</span><br><span class="line">    .pin = GPIO_Pin_5,</span><br><span class="line">    .on_lvl = Bit_RESET,</span><br><span class="line">    .off_lvl = Bit_SET,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">led_desc_t</span> led1 =</span><br><span class="line">&#123;</span><br><span class="line">    .clk_source = RCC_AHB1Periph_GPIOE,</span><br><span class="line">    .port = GPIOE,</span><br><span class="line">    .pin = GPIO_Pin_6,</span><br><span class="line">    .on_lvl = Bit_RESET,</span><br><span class="line">    .off_lvl = Bit_SET,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">led_desc_t</span> led2 =</span><br><span class="line">&#123;</span><br><span class="line">    .clk_source = RCC_AHB1Periph_GPIOC,</span><br><span class="line">    .port = GPIOC,</span><br><span class="line">    .pin = GPIO_Pin_13,</span><br><span class="line">    .on_lvl = Bit_RESET,</span><br><span class="line">    .off_lvl = Bit_SET,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">led_delay</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">uint32_t</span> a = <span class="number">0</span>; a &lt; <span class="number">1000</span>; a++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">uint32_t</span> b = <span class="number">0</span>;b &lt; <span class="number">1000</span>; b++)</span><br><span class="line">        &#123;</span><br><span class="line">            __NOP();</span><br><span class="line">            __NOP();</span><br><span class="line">            __NOP();</span><br><span class="line">            __NOP();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">led_init</span><span class="params">(<span class="type">const</span> <span class="type">led_desc_t</span> *desc)</span></span><br><span class="line">&#123;</span><br><span class="line">    RCC_AHB1PeriphClockCmd(desc-&gt;clk_source, ENABLE);</span><br><span class="line"></span><br><span class="line">    GPIO_InitTypeDef ginit;</span><br><span class="line">    <span class="built_in">memset</span>(&amp;ginit, <span class="number">0</span>, <span class="keyword">sizeof</span>(GPIO_InitTypeDef));</span><br><span class="line">    ginit.GPIO_Pin = desc-&gt;pin;</span><br><span class="line">    ginit.GPIO_Mode = GPIO_Mode_OUT;</span><br><span class="line">    ginit.GPIO_OType = GPIO_OType_PP;</span><br><span class="line">    ginit.GPIO_Speed = GPIO_Medium_Speed;</span><br><span class="line">    GPIO_Init(desc-&gt;port, &amp;ginit);</span><br><span class="line"></span><br><span class="line">    GPIO_WriteBit(desc-&gt;port, desc-&gt;pin, desc-&gt;off_lvl);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">led_deinit</span><span class="params">(<span class="type">const</span> <span class="type">led_desc_t</span> *desc)</span></span><br><span class="line">&#123;</span><br><span class="line">    GPIO_WriteBit(desc-&gt;port, desc-&gt;pin, desc-&gt;off_lvl);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">led_on</span><span class="params">(<span class="type">const</span> <span class="type">led_desc_t</span> *desc)</span></span><br><span class="line">&#123;</span><br><span class="line">    GPIO_WriteBit(desc-&gt;port, desc-&gt;pin, desc-&gt;on_lvl);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">led_off</span><span class="params">(<span class="type">const</span> <span class="type">led_desc_t</span> *desc)</span></span><br><span class="line">&#123;</span><br><span class="line">    GPIO_WriteBit(desc-&gt;port, desc-&gt;pin, desc-&gt;off_lvl);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    led_init(&amp;led0);</span><br><span class="line">    led_init(&amp;led1);</span><br><span class="line">    led_init(&amp;led2);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        led_on(&amp;led0);</span><br><span class="line">        led_on(&amp;led1);</span><br><span class="line">        led_on(&amp;led2);</span><br><span class="line">        led_delay();</span><br><span class="line"></span><br><span class="line">        led_off(&amp;led0);</span><br><span class="line">        led_off(&amp;led1);</span><br><span class="line">        led_off(&amp;led2);</span><br><span class="line">        led_delay();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></section>
    

    <footer id="post-meta" class="clearfix">
        <a href="/about/">
        <img class="avatar" src="/images/me.jpg">
        <div>
            <span class="dark">风继续吹</span>
            <span></span>
        </div>
        </a>
        <section id="sharing">
            <a title="Share to Twitter" class="twitter" target="_blank" rel="noopener" href="https://twitter.com/intent/tweet?text=http://example.com/2025/09/18/2025-9-18%E7%9F%A5%E8%AF%86%E7%AC%94%E8%AE%B0/ - 2025.9.18知识笔记 @"><span class="icon-twitter">tweet</span></a>
            <a title="Share to Facebook" class="facebook" href="#" onclick="
                window.open(
                  'https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),
                  'facebook-share-dialog',
                  'width=626,height=436');
                return false;"><span class="icon-facebook-sign">Share</span>
            </a>
        </section>
    </footer>


  <section id="comment">
    <button class="btn" id="loadcmts" onclick="cmts.load();">Load Comments</button>
    <div id="gitment"></div>
    <script src='/js/gitment.browser.js'></script>
    <link rel="stylesheet" href=''>
    <script>
      var cmts={
        load:function cmts(){
          var gitment = new Gitment({
          
            id: "2025.9.18知识笔记",
          
            owner: "",
            repo: "",
            oauth: {
              client_id: "",
              client_secret: "",
            },
          })
          gitment.render('gitment');
          var loadcmt = document.getElementById("loadcmts");
          var imyourfather = loadcmt.parentNode;
          imyourfather.removeChild(loadcmts)
        }
      }
    </script>
  </section>


    
        <ul id="post-list" class="archive readmore">
        <h3>Read more</h3>
        
            <li>
    <aside class="dates">Sep 21 2100</aside>
    <a href="/2100/09/21/C%E8%AF%AD%E8%A8%80---%E5%88%9D%E7%AA%A5%E9%97%A8%E5%BE%84/">C语言---初窥门径</a>
    <h2></h2>
</li>
        
            <li>
    <aside class="dates">Sep 19 2100</aside>
    <a href="/2100/09/19/%E9%87%8D%E8%A6%81%E8%8A%AF%E7%89%87%E5%9E%8B%E5%8F%B7%E8%AE%B0%E5%BD%95%E8%A1%A8/">重要芯片型号记录表</a>
    <h2></h2>
</li>
        
            <li>
    <aside class="dates">Sep 19 2025</aside>
    <a href="/2025/09/19/2025-9-19%E7%9F%A5%E8%AF%86%E7%AC%94%E8%AE%B0/">PLL、RAM、FIFO三大IP核入门</a>
    <h2></h2>
</li>
        
            <li>
    <aside class="dates">Sep 18 2025</aside>
    <a href="/2025/09/18/2025-9-18%E7%9F%A5%E8%AF%86%E7%AC%94%E8%AE%B0/">2025.9.18知识笔记</a>
    <h2></h2>
</li>
        
            <li>
    <aside class="dates">Sep 16 2025</aside>
    <a href="/2025/09/16/2025-9-16%E7%9F%A5%E8%AF%86%E7%AC%94%E8%AE%B0/">2025.9.16知识笔记</a>
    <h2></h2>
</li>
        
            <li>
    <aside class="dates">Sep 15 2025</aside>
    <a href="/2025/09/15/2025-9-15%E7%9F%A5%E8%AF%86%E7%AC%94%E8%AE%B0/">2025.9.15知识笔记</a>
    <h2></h2>
</li>
        
            <li>
    <aside class="dates">Sep 14 2025</aside>
    <a href="/2025/09/14/2025-9-14%E7%9F%A5%E8%AF%86%E7%AC%94%E8%AE%B0/">2025.9.14知识笔记</a>
    <h2></h2>
</li>
        
            <li>
    <aside class="dates">Sep 13 2025</aside>
    <a href="/2025/09/13/2025-9-13%E7%9F%A5%E8%AF%86%E7%AC%94%E8%AE%B0/">2025.9.13知识笔记</a>
    <h2></h2>
</li>
        
        </ul>
    

	<footer id="footer">
	<div id="social">
		<p class="small">© Copyright 2025
			<a href="/"> laozhichi </a>/
			<a target="_blank" rel="noopener" href="https://hexo.io"> Hexo </a>/
			<a target="_blank" rel="noopener" href="https://github.com/caisiduo/hexo-theme-lightime"> Lightime</a>
		</p>
	</div>
</footer>
</section>

	<script src="//cdnjs.loli.net/ajax/libs/instantclick/3.0.1/instantclick.min.js" data-no-instant></script>
	<script data-no-instant>
		
		InstantClick.init('mousedown');
	</script>



